"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const requisition_adopter_1 = require("../components/requisition-adopter");
const requisition_validator_1 = require("./requisition-validator");
const logger_1 = require("../loggers/logger");
class ComponentImporter {
    importRequisition(requisition) {
        const importValue = requisition.import;
        if (importValue) {
            const imported = Array.isArray(importValue) ? { requisitions: importValue } : importValue;
            const requisitionValidator = new requisition_validator_1.RequisitionValidator();
            if (!requisitionValidator.validate(imported)) {
                const message = `Error importing ${JSON.stringify(importValue)}: ${requisitionValidator.getErrorMessage()}`;
                logger_1.Logger.error(message);
                throw message;
            }
            const merged = Object.assign({}, requisition, imported);
            return new requisition_adopter_1.RequisitionAdopter(merged).getRequisition();
        }
        return requisition;
    }
    importSubscription(subscription) {
        const importValue = subscription.import;
        if (importValue) {
            return Object.assign({}, subscription, importValue);
        }
        return subscription;
    }
    importPublisher(publisherModel) {
        const importValue = publisherModel.import;
        if (importValue) {
            return Object.assign({}, publisherModel, importValue);
        }
        return publisherModel;
    }
}
exports.ComponentImporter = ComponentImporter;
